<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <title>Termine – Milane Tattoo Studio</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <!-- Global Styles -->
  <link rel="stylesheet" href="styles.css">
</head>

<body class="bg-dark text-light">

  <div class="container pt-3 pb-5">

    <!-- HEADER -->
    <header class="mb-4">
      <h1 class="h4 mb-0">
        <i class="bi bi-calendar-plus me-2"></i>Neuer Termin
      </h1>
      <small class="text-muted">Kundenbuchung erfassen</small>
    </header>


    <!-- FORM CARD -->
    <div class="card card-glass p-4">

      <form id="termin-form">

        <!-- Name -->
        <div class="mb-3">
          <label class="form-label text-muted">Kundenname</label>
          <input
            type="text"
            id="client_name"
            class="form-control"
            placeholder="z. B. Sarah Müller"
            required
          >
        </div>

        <!-- Datum & Zeit -->
        <div class="mb-3">
          <label class="form-label text-muted">Datum & Uhrzeit</label>
          <input
            type="datetime-local"
            id="date_time"
            class="form-control"
            required
          >
        </div>

        <!-- Preis -->
        <div class="mb-3">
          <label class="form-label text-muted">Preis (CHF)</label>
          <input
            type="number"
            id="price"
            step="0.05"
            class="form-control"
            placeholder="150.00"
            required
          >
        </div>

        <!-- Notiz -->
        <div class="mb-3">
          <label class="form-label text-muted">Notiz (optional)</label>
          <textarea
            id="note"
            class="form-control"
            rows="2"
            placeholder="Motiv, Dauer, Besonderheiten …"
          ></textarea>
        </div>

        <!-- Button -->
        <button class="btn btn-primary w-100 py-2">
          <i class="bi bi-save me-2"></i>Termin speichern
        </button>

      </form>

      <p id="status" class="mt-2"></p>

    </div>
  </div>


  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="index.html">
      <i class="bi bi-house-door"></i>
      <span>Home</span>
    </a>

    <a href="rechner.html">
      <i class="bi bi-calculator"></i>
      <span>Rechner</span>
    </a>

    <a href="termine.html" class="active">
      <i class="bi bi-calendar-check"></i>
      <span>Termine</span>
    </a>

    <a href="einnahmen.html">
      <i class="bi bi-wallet2"></i>
      <span>Einnahmen</span>
    </a>
  </nav>


  <!-- Supabase v1 -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@1.35.7/dist/umd/supabase.min.js"></script>

  <script>
    const SUPABASE_URL = "https://qnpufvlklhpjkuzifzeb.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFucHVmdmxrbGhwamt1emlmemViIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQzMjAxMTYsImV4cCI6MjA3OTg5NjExNn0.wY7565zw5j5qpoD8OMLa78QmjZ8PG6uhHaBO3xBwmJA";

    const db = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    document.getElementById("termin-form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const client_name = document.getElementById("client_name").value.trim();
      const date_time   = document.getElementById("date_time").value;
      const price       = parseFloat(document.getElementById("price").value);
      const note        = document.getElementById("note").value.trim();

      const { error } = await db
        .from("appointments")
        .insert([
          { client_name, date_time, price, note }
        ]);

      const status = document.getElementById("status");

      if (error) {
        status.innerHTML = `<span class="text-danger">❌ Fehler: ${error.message}</span>`;
      } else {
        status.innerHTML = `<span class="text-success">✅ Termin gespeichert!</span>`;
        document.getElementById("termin-form").reset();
      }
    });
  </script>

</body>
</html>
